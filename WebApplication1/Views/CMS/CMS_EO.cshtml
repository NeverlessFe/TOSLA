
@{
    ViewBag.Title = "CMS_EO";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>

    .dataTables_filter {
        position: relative;
    }

        .dataTables_filter input {
            width: 250px;
            height: 32px;
            background: #fcfcfc;
            border: 1px solid #aaa;
            border-radius: 5px;
            box-shadow: 0 0 3px #ccc, 0 10px 15px #ebebeb inset;
            text-indent: 10px;
        }

        .dataTables_filter .fa-search {
            position: absolute;
            top: 10px;
            left: auto;
            right: 10px;
        }
</style>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">CMS EO</h4>
                    <div class="row form-group-sm">
                        <div class="col-md-6">
                            <label class="m-t-20">Nama EO<span style="color: red">*</span></label>
                            <input type="text" id="Nama_EO" />
                        </div>
                    </div>
                    <div class="row form-group-sm">
                        <div class="col-md-6">
                            <label class="m-t-20">Bank EO<span style="color: red">*</span></label>
                            <input type="text" id="Bank_EO" />
                        </div>
                    </div>
                    <div class="row form-group-sm">
                        <div class="col-md-6">
                            <label class="m-t-20">No Rekening EO<span style="color: red">*</span></label>
                            <input type="text" id="No_Rek_EO" />
                        </div>
                    </div>
                    <div class="row form-group-sm">
                        <div class="col-md-6">
                            <label class="m-t-20">Atas Nama EO<span style="color: red">*</span></label>
                            <input type="text" id="Atas_Nama_EO" />
                        </div>
                    </div>
                    <div class="row form-group-sm mt-3">
                        <div class="col-md-6">
                            <button class="btn btn-primary" id="Insert_EO" disabled>Insert EO</button>
                        </div>
                    </div>
                    <div class="row form-group-sm mt-3">
                        <div id="form_tableSPB" class="form-group row" hidden>
                            <table id="tbl_EO" class="table table-striped table-bordered zero-configuration">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Nama</th>
                                        <th>Bank</th>
                                        <th>No Rekening</th>
                                        <th>Atas Nama</th>
                                        <th>Nomor Rekening</th>
                                    </tr>
                                </thead>
                                <tbody id="tBodyPA">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        getEO();
        $('#Insert_EO').click(function () {

        });
        $('#SubdistBayar').change(function () {
            $('#View_Report').attr('disabled', false);
        })
    })
    function getEO() {
        var dictlist = {
            Option: 1
        }
        var dto = {
            Model: dictlist
        }
        $.ajax({
            url: "../UploadMemo/DynamicController?spname=SP_CMS_MasterEO",
            type: "POST",
            dataType: "json",
            data: JSON.stringify(dto),
            contentType: "application/json;charset=utf-8",
            success: function (data) {
                var table = $('#tbl_EO').DataTable({
                    "pageLength": 50,
                    "data": JSON.parse(data),
                    "filter": true,
                    "lengthChange": true,
                    "paging": true,
                    "info": true,
                    "searching": true,
                    "select": true,
                    "bDestroy": true,
                    "scrollCollapse": true,
                    "columns": [
                        { "data": "NoEO" },
                        { "data": "NamaEO" },
                        { "data": "BankEO" },
                        { "data": "NoRekeningEO" },
                        { "data": "AtasNamaEO" },
                        {
                            "data": null,
                            "defaultContent": "<input class='btn btn-primary' id='btn_Update' style='background-color:orange;' type='button' />"
                        },

                        {
                            "data": null,
                            "defaultContent": "<input class='btn btn-primary' id='btn_Delete' style='background-color:red;' type='button' />"
                        },
                    ],
                    "columnDefs": [
                        {
                            "targets": [0],
                            "visible": false,
                            "searchable": false
                        },
                    ],
                    "order": [[1, 'asc']],
                });

            }, error: function (ex) {
                console.log(JSON.stringify(ex))
            }
        });
        //var row = table.row(i);
        //var tr = $(row.node());
        //var checkbox = tr.find('td:first-child input[type="checkbox"]')

    }
    function InsertEO() {
        var valid = false;
        var dictlist = {
            Option: 2,
            Nama_EO: $('#Nama_EO').val(),
            Bank_EO: $('#Bank_EO').val(),
            No_Rek_EO: $('#No_Rek_EO').val(),
            Atas_Nama_EO: $('#Atas_Nama_EO').val(),
        }
        $.each(dictlist, function (key, value) {
            var keysplit = key.split('_');
            if (value == null || value == '') {
                if (keysplit.length == 3) {

                    swal({
                        title: "Error!",
                        text: "Silahakan melengkapi " + keysplit[0] + " " + keysplit[1] + "" + keysplit[2] + " yang kosong terlebih dahulu",
                        type: "error",
                        showConfirmButton: false,
                        timer: 2000,
                    });
                    return valid = false;
                }
                else {
                    swal({
                        title: "Error!",
                        text: "Silahakan melengkapi " + keysplit[0] + " " + keysplit[1] + " yang kosong terlebih dahulu",
                        type: "error",
                        showConfirmButton: false,
                        timer: 2000,
                    });
                    return valid = false;
                }
            }

        });
        var dto = {
            Model: dictlist
        }
        if (valid == true) {
            $.ajax({
                url: "../UploadMemo/DynamicController?spname=SP_CMS_MasterEO",
                type: "POST",
                dataType: "json",
                data: JSON.stringify(dto),
                contentType: "application/json;charset=utf-8",
                success: function (data) {


                }, error: function (ex) {
                    console.log(JSON.stringify(ex))
                }
            });
        }
    }
</script>

